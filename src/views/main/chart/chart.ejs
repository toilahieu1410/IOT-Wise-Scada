<!DOCTYPE html>
<html lang="en">
<head>
    <title>Wise Scada</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="shortcut icon" href="images/logo_favicon/favicon-trungquandev.png" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/series-label.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://code.highcharts.com/modules/no-data-to-display.js"></script>
    <script src="js/chart/exportExcel/exportExcel.js"></script>
</head>
<!-- include('navbar'); -->

<%- include('./../navbar/navbar.ejs') %>
<body>
    <div class="main-panel" id="main-panel">
        <div class="se-pre-con"></div> 
        <div class="chart-query">
            <div class="form-chart-data">
                <div class="col-md-12" style="margin:25px 0 10px 0">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-header-title" style="display:inline-flex;position: relative;left:5em;">
                                <h2 class="title" style="color:#fff;"><img src="/images/icons/icon_wise-white/chart_white.png" style="width:50px;margin-right:10px"><span style="position:relative;top:10px">Chart</span></h3>
                                    <div class="query-datetime" style="display: flex;position: relative;left: 2em;top:10px">
                                        <div  class="form-group input-with-post-icon " style="display:flex;position: relative;">
                                          <h2 style="color:#fff">01/09/2020</h2>
                                      </div>
                                      &nbsp;&nbsp;&nbsp;
                                      <span style="font-weight:bold;font-size:28px;color:#fff">-</span>
                                      &nbsp;&nbsp;&nbsp;
                                      <div  class="form-group input-with-post-icon " style="display:flex;position: relative;">
                                        <h2 style="color:#fff">20/09/2020</h2>
                                    </div>
                                    </div>
                                 
                            </div>
                            <div class="button-search" style="position: relative;float:right;right:5em">
                                <button type="submit" class="btn btn-search"  href="/chart" style="background-color: #114237ab;font-size: 16px;color: white;margin:1rem 0"><img width="25" src="../images/icons/icon_wise-white/search.png"/>Search</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-table">
                                <div class="table-responsive" style="max-height: 285px;">
                                    <table class="table" >
                                        <thead>
                                            <tr>
                                                <th style="min-width: 100px;" class="time">Time</th>
                                                <th style="min-width: 110px;">Nhiệt độ khói thải</th>
                                                <th style="min-width: 130px;">Nhiệt độ nước</th>
                                                <th style="min-width: 130px;">Áp suất hơi</th>
                                                <th style="min-width: 130px;">Chân không buồng đốt</th>
                                                <th style="min-width: 130px;">Buồng đốt TS1</th>
                                                <th style="min-width: 130px;">Buồng đốt TS2</th>
                                                <th style="min-width: 130px;">Áp suất gió</th>
                                                 <th style="width:50px">
                                                    <a id="myBtn" class="dropbtn" style="color:#fff;cursor: pointer;" onclick="tablesToExcelMultiTabs(['export-chart'], ['Scada'], '', 'Excel')">
                                                        ...
                                                    </a>
                                                
                                                </th> 
                                         
                                            </tr>
                                        </thead>
                                        <tbody style="overflow-y: auto;">
                                            <% getDataChart.forEach(item => { %>
                                                <tr >
                                                    <td><%= moment(item.createdAt).format('DD/MM hh:mm a') %></td>
                                                    <td class="text-center"><%= item.nhietDoKhoiThai %></td>
                                                    <td class="text-center"><%= item.nhietDoNuoc %></td>
                                                    <td class="text-center"><%= item.apSuatHoi %></td>
                                                    <td class="text-center"><%= item.chanKhongBuongDot %></td>
                                                    <td class="text-center"><%= item.buongDot_TS1 %></td>
                                                    <td class="text-center"><%= item.buongDot_TS2 %></td>
                                                    <td class="text-center"><%= item.apSuatGio %></td>
                                                    <td></td>
                                                  </tr>
                                            <% }) %>
                                              
                                              
                                        </tbody>
                                      </table>
                                      </div>
                            </div>
                           
                            <div class="form-table" style="display:none" id="export-chart" data-SheetName="Scada">
                                <div class="table-responsive" style="max-height: 400px;">
                                    <table style="border:0;" cellpadding="10" cellspacing="10"  >
                                        <tr>
                                            <td colspan="2" align="center">
                                                <p style="font-size:18px"><b>WISE Scada</b></p>
                                                <p> -----------o0o------------</p>
                                            </td>
                                            <td colspan="2" align="center">
                                                <p style="font-size:18px"><b>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</b></p>
                                                <p style="font-weight:bold">Độc lập – Tự do – Hạnh Phúc</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"></td>
                                            <td colspan="2" align="center">
                                                -----------o0o------------
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"></td>
                                            <td colspan="2" align="center">
                                                ........., ngày .....&nbsp;tháng.....&nbsp;năm.....
                                            </td>
                                        </tr>
                                    </table>
                                    <table class="table" >
                                        <thead>
                                            <tr>
                                                <th style="min-width: 100px;" class="time" style="text-align:center;">Time</th>
                                                <th style="min-width: 110px;" style="text-align:center;">Nhiệt độ khói thải</th>
                                                <th style="min-width: 130px;" style="text-align:center;">Nhiệt độ nước</th>
                                                <th style="min-width: 130px;" style="text-align:center;">Áp suất hơi</th>
                                                <th style="min-width: 130px;" style="text-align:center;">Chân không buồng đốt</th>
                                                <th style="min-width: 130px;" style="text-align:center;">Buồng đốt TS1</th>
                                                <th style="min-width: 130px;" style="text-align:center;">Buồng đốt TS2</th>
                                                <th style="min-width: 130px;" style="text-align:center;">Áp suất gió</th>
                                        
                                            </tr>
                                        </thead>
                                        <tbody style="overflow-y: auto;">
                                            <% getDataChart.forEach(item => { %>
                                                <tr >
                                                    <td><%= moment(item.createdAt).format('DD/MM hh:mm a') %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.nhietDoKhoiThai %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.nhietDoNuoc %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.apSuatHoi %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.chanKhongBuongDot %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.buongDot_TS1 %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.buongDot_TS2 %></td>
                                                    <td class="text-center" style="text-align:center;"><%= item.apSuatGio %></td>
                                                    <td></td>
                                                  </tr>
                                            <% }) %>
                                              
                                              
                                        </tbody>
                                      </table>
                                      </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <div class="form-chart">
                                    <figure class="">
                                        <div id="chart2" name="chart2"></div>
                                    </figure>
                                    <figure class="">
                                        <div id="chart3" name="chart3"></div>
                                    </figure>
                                </div>
                       
                              
                            </div>
                          
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="row">
                        <div class="form-chart">
                            <figure class="">
                                <div id="chart4" name="chart4"></div>
                            </figure>
                            <figure class="">
                                <div id="chart5" name="chart5"></div>
                            </figure>
                            <figure class="">
                                <div id="chart1" name="chart1"></div>
                            </figure>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>

    
<!--     
       
    
      
            <div id="chart6" name="chart6"></div>

    
  
            <div id="chart7" name="chart7"></div> -->
       
    </div>
     <!-- Start load page -->
     <%- include('../loadpage/loadpage.ejs') -%>
     <!-- End load page -->
</body>
<script>
    let dateTime = ['<%= dateTime %>'];
    let arrDateTime = dateTime[0].split(',')
    let nhietDoKhoiThai = [<%= nhietDoKhoiThai %>];
    let nhietDoNuoc = [<%= nhietDoNuoc %>];
    let apSuatHoi = [<%= apSuatHoi %>];
    let chanKhongBuongDot = [<%= chanKhongBuongDot %>];
    let buongDot_TS1 = [<%= buongDot_TS1 %>];
    let buongDot_TS2 = [<%= buongDot_TS2 %>];
    let apSuatGio = [<%= apSuatGio %>];
    let sumNhietDoKhoiThai = <%= sumNhietDoKhoiThai %>;
    let sumNhietDoNuoc = <%= sumNhietDoNuoc %>;
    let sumApSuatHoi = <%= sumApSuatHoi %>;
</script>
<script src="js/chart/chart.js"></script>

<style>
      tr:nth-child(even) {
  background-color: #0c0b0b2b;
}
.form-group {
    margin-bottom: 0;
}
tbody tr td:first-child {
    background-color: #176866e3 ;
    position: sticky;
    left: -1px;
    z-index: 2;
}
thead th.time:first-child, tfoot th:first-child {
    position: sticky;
    left: -1px;
    z-index: 1000;
}
    .highcharts-figure, .highcharts-data-table table {
    min-width: 360px; 
    max-width: 800px;
    margin: 1em auto;
}

.highcharts-data-table table {
	font-family: Verdana, sans-serif;
	border-collapse: collapse;
	border: 1px solid #EBEBEB;
	margin: 10px auto;
	text-align: center;
	width: 100%;
	max-width: 500px;
}
.highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
}
.highcharts-data-table th {
	font-weight: 600;
    padding: 0.5em;
}
.highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
    padding: 0.5em;
}
.highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}
.highcharts-data-table tr:hover {
    background: #f1f7ff;
}
table thead th {
    position: sticky;
    top:0;
    z-index: 9;
}
.table-responsive::-webkit-scrollbar {
    width: 5px;
    height: 5px;
}
.table-responsive::-webkit-scrollbar-thumb {
    -webkit-border-radius: 5px;
    border-radius: 5px;
    background: #cccccc96;
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5);
}
.table-responsive::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
    -webkit-border-radius: 5px; 
     border-radius: 5px; 
}
</style>
</html>
